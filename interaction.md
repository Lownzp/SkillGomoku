# 五子棋技能系统 - 交互设计文档

## 核心交互机制

### 游戏主界面布局

#### 桌面端布局（1920x1080）
```
┌─────────────────────────────────────────────────────────────┐
│                    顶部导航栏                                  │
├───────────────┬─────────────────────────┬───────────────────┤
│               │                         │                   │
│   左侧信息面板   │      中央棋盘区域          │    右侧技能面板     │
│               │                         │                   │
│  - 玩家信息     │     15x15游戏棋盘         │  - 技能列表显示    │
│  - 能量条       │                         │  - 冷却时间显示    │
│  - 回合指示器   │                         │  - 使用按钮状态    │
│  - 胜利条件提示 │                         │  - 能量消耗提示    │
│               │                         │                   │
│  - 设置按钮     │                         │  - 自定义技能入口  │
│               │                         │                   │
└───────────────┴─────────────────────────┴───────────────────┘
```

#### 移动端布局（自适应）
```
┌─────────────────────┐
│      顶部状态栏       │
├─────────────────────┤
│                     │
│    中央棋盘区域        │
│                     │
├─────────────────────┤
│    底部技能面板        │
│  (可滑动切换技能)      │
└─────────────────────┘
```

## 详细交互流程

### 1. 游戏初始化

#### 启动流程
1. 加载游戏资源（音效、图片、动画）
2. 初始化棋盘状态（15x15空矩阵）
3. 设置玩家初始状态
   - 能量值：3点
   - 技能冷却：全部可用
   - 回合数：0

#### 玩家状态面板
```javascript
玩家信息区域：
┌─────────────────┐
│ 玩家1 (黑子)     │
│ 能量：[●●●○○]    │
│ 回合：第1回合    │
│ 状态：轮到你     │
└─────────────────┘
```

### 2. 回合制交互

#### 每回合流程
1. **回合开始阶段**
   - 能量恢复 +1（上限5点）
   - 技能冷却更新
   - 播放回合开始音效

2. **玩家决策阶段**
   - 可选行动：
     - 落子（消耗0能量）
     - 使用技能（消耗对应能量）
     - 查看技能详情

3. **行动执行阶段**
   - 执行选择的行动
   - 更新游戏状态
   - 播放相应动画

4. **回合结束阶段**
   - 检查胜利条件
   - 切换玩家回合
   - 更新界面显示

### 3. 落子交互

#### 鼠标/触摸操作
```javascript
落子流程：
1. 鼠标悬停在棋盘上
   - 显示预览棋子（半透明）
   - 高亮显示目标位置
   
2. 点击确认落子
   - 播放落子音效
   - 棋子动画落下
   - 更新棋盘状态
   
3. 胜利检测
   - 检查五子连珠
   - 显示胜利动画
   - 播放胜利音效
```

#### 视觉反馈
- **悬停状态**：目标位置显示半透明棋子
- **确认落子**：棋子从上方落下，带有重力效果
- **连五高亮**：胜利的五子发光闪烁

### 4. 技能系统交互

#### 技能面板设计
```javascript
技能面板布局：
┌─────────────────────────┐
│        技能系统           │
├─────────────────────────┤
│ ┌─────┐ ┌─────┐ ┌─────┐ │
│ │飞沙 │ │时光 │ │固若 │ │
│ │走石 │ │冻结 │ │金汤 │ │
│ │[●●] │ │[●●] │ │[●]  │ │
│ │2回合 │ │4回合 │ │3回合 │ │
│ └─────┘ └─────┘ └─────┘ │
│ ┌─────┐ ┌─────┐ ┌─────┐ │
│ │力拔 │ │时光 │ │移花 │ │
│ │山兮 │ │倒流 │ │接木 │ │
│ │[●●●]│ │[●●●]│ │[●]  │ │
│ │7回合 │ │5回合 │ │2回合 │ │
│ └─────┘ └─────┘ └─────┘ │
└─────────────────────────┘
```

#### 技能使用流程

**步骤1：选择技能**
- 点击技能图标
- 显示技能详情弹窗
- 确认是否使用

**步骤2：目标选择（如需要）**
- 飞沙走石：点击要移除的对手棋子
- 画地为牢：拖拽选择3x3区域
- 其他技能：自动生效

**步骤3：确认执行**
- 显示技能效果预览
- 确认执行
- 扣除能量和设置冷却

#### 技能效果动画

**飞沙走石效果**：
1. 目标棋子开始摇晃
2. 粒子效果（沙石飞舞）
3. 棋子碎裂消失
4. 音效配合

**时光倒流效果**：
1. 时间倒流视觉特效
2. 最近落子逆向动画
3. 棋盘状态回退
4. 时间波纹效果

**力拔山兮效果**：
1. 全场棋子浮起
2. 旋转洗牌动画
3. 棋子重新落下
4. 震动效果

### 5. 自定义技能交互

#### 技能创建界面
```javascript
自定义技能编辑器：
┌─────────────────────────────┐
│      创建新技能              │
├─────────────────────────────┤
│ 技能名称：[________] (四字成语) │
│                             │
│ 技能类型：[下拉选择]          │
│ - 攻击类  - 防御类  - 控制类  │
│                             │
│ 技能效果：[多选框]           │
│ □ 移除棋子  □ 移动棋子        │
│ □ 跳过回合  □ 区域限制        │
│ □ 撤销操作  □ 其他效果        │
│                             │
│ 能量消耗：[滑块 1-5]          │
│ 冷却时间：[滑块 1-8回合]       │
│                             │
│ [预览效果] [保存技能] [取消]   │
└─────────────────────────────┘
```

#### 创建流程
1. **输入验证**
   - 检查成语有效性
   - 验证技能平衡性
   - 计算强度评分

2. **效果预览**
   - 模拟技能效果
   - 显示动画预览
   - 测试平衡性

3. **提交审核**
   - 社区投票
   - 管理员审核
   - 正式上线

### 6. 游戏状态管理

#### 状态机设计
```javascript
gameState = {
    currentPlayer: 'black',  // 当前玩家
    board: [],              // 棋盘状态
    energy: {               // 能量状态
        black: 3,
        white: 3
    },
    cooldowns: {            // 技能冷却
        black: {},
        white: {}
    },
    history: [],            // 历史记录
    winner: null,           // 胜利者
    gameMode: 'pvp'         // 游戏模式
}
```

#### 状态同步
- 实时更新界面显示
- 保存游戏进度
- 支持断线重连

### 7. 音效系统

#### 音效分类
- **界面音效**：按钮点击、悬停
- **游戏音效**：落子、技能释放
- **环境音效**：背景音乐、胜利庆祝

#### 音效触发
```javascript
音效事件映射：
- 'piecePlace' → 落子音效
- 'skillActivate' → 技能释放
- 'victory' → 胜利音效
- 'buttonHover' → 悬停音效
```

### 8. 移动端适配

#### 触摸优化
- 增大点击区域
- 支持双指缩放
- 滑动切换技能

#### 性能优化
- 减少DOM操作
- 使用Canvas渲染
- 图片资源压缩

### 9. 多语言支持

#### 界面国际化
- 中文（默认）
- 英文
- 日文

#### 技能名称处理
- 保持中文成语原样
- 添加英文解释
- 文化背景说明

## 用户体验优化

### 新手引导
1. **首次游戏教程**
   - 基础规则介绍
   - 技能使用演示
   - 实战练习关卡

2. **提示系统**
   - 可落子位置高亮
   - 技能使用建议
   - 策略提示

### 可访问性
- 键盘导航支持
- 屏幕阅读器兼容
- 色盲友好配色
- 字体大小调节

### 性能监控
- 帧率监控
- 内存使用优化
- 加载时间统计
- 错误日志记录